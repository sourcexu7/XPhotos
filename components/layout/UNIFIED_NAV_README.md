# 统一导航栏 & 前台主题切换功能

## 功能概述

已实现所有页面（首页、相册页）的统一导航栏，并添加前台用户主题切换功能。

## 主要特性

### 1. 统一导航栏 (`UnifiedNav`)
- **位置**: 所有页面顶部固定显示
- **组成部分**:
  - 左侧: Logo
  - 中间: 相册选择器（可切换"全部照片"和各个相册）
  - 右侧: 主题选择器 + 图标组（首页、相册、设置）

### 2. 主题选择器 (`ThemeSelector`)
- **可选主题**:
  - 默认主题 (0)
  - 单列主题 (1)
  - 瀑布流主题 (2)
- **功能**:
  - 用户可在前台自由切换主题
  - 选择的主题保存到浏览器 localStorage
  - 优先使用用户选择，否则使用后台配置的默认主题
  - 切换后自动刷新页面应用新主题

### 3. 相册选择器 (`AlbumSelector`)
- 下拉菜单显示所有相册
- 始终包含"全部照片"选项（回到首页）
- 支持在任意页面切换相册
- 当前选中的相册高亮显示

## 技术实现

### 文件结构
```
components/layout/
├── unified-nav.tsx              # 统一导航栏主组件
├── theme-selector.tsx           # 主题选择器
├── theme-gallery-client.tsx     # 客户端主题渲染
└── theme/waterfall/nav/
    └── album-selector.tsx       # 相册选择器

app/
├── (default)/
│   ├── layout.tsx              # 首页 layout（使用统一导航栏）
│   └── page.tsx                # 首页（动态主题渲染）
└── (theme)/[...album]/
    └── layout.tsx              # 相册页 layout（使用统一导航栏）
```

### 主题切换逻辑
1. 用户点击主题选择器
2. 选择的主题值保存到 `localStorage.preferredTheme`
3. 页面刷新，重新读取主题设置
4. 优先级：用户选择 > 后台配置

### 数据同步
- 所有导航栏组件都从服务端获取最新的相册列表
- 相册选择器自动过滤掉根路径 `/`（避免重复）
- 显示所有未删除的相册（`del: 0`）

## 多语言支持

已添加以下语言的翻译：
- 简体中文 (zh)
- 繁体中文 (zh-TW)
- 英文 (en)
- 日文 (ja)

翻译文件位置: `messages/*.json`

## 使用说明

### 前台用户
1. 访问网站首页或任意相册页
2. 顶部导航栏始终显示
3. 点击中间的相册选择器，可切换到其他相册或回到"全部照片"
4. 点击右侧的主题选择器图标，选择喜欢的主题样式
5. 主题会自动保存，下次访问时自动应用

### 后台管理员
- 可在后台 "设置 > 首选项" 中配置默认主题
- 前台用户的个人选择会覆盖默认设置
- 新用户首次访问时使用后台配置的默认主题

## 注意事项

1. 主题切换依赖浏览器 localStorage，清除浏览器数据会重置为默认主题
2. 导航栏在所有页面保持一致，确保用户体验流畅
3. 相册数据实时从数据库读取，无需手动刷新

## 更新日期

2025年11月25日
